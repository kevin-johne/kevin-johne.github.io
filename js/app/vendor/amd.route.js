define([],function(){"use strict";function t(t){return t.split(/[/?#]/)}function e(t,e){var n=new RegExp("^"+e[x](/\*/g,"([^/?#]+?)")[x](/\.\./,".*")+"$"),r=t.match(n);return r?r.slice(1):void 0}function n(t,e){var n;return function(){clearTimeout(n),n=setTimeout(t,e)}}function r(t){h=n(c,1),T[$](K,h),T[$](N,h),E[$](q,s),t&&c(!0)}function i(){this.$=[],g(this),D.on("stop",this.s.bind(this)),D.on("emit",this.e.bind(this))}function o(t){return t[x](/^\/|\/$/,"")}function u(t){return"string"==typeof t}function f(t){return(t||j.href)[x](b,"")}function a(t){return"#"===p[0]?(t||j.href||"").split(p)[1]||"":(j?f(t):t||"")[x](p,"")}function c(t){var e=0===z;if(!(z>=S)&&(z++,_.push(function(){var e=a();(t||e!==d)&&(D[O]("emit",e),d=e)}),e)){for(var n;n=_.shift();)n();z=0}}function s(t){if(!(1!==t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.target;e&&"A"!==e.nodeName;)e=e.parentNode;!e||"A"!==e.nodeName||e[A]("download")||!e[A]("href")||e.target&&"_self"!==e.target||-1===e.href.indexOf(j.href.match(b)[0])||(e.href===j.href||!(e.href.split("#")[0]===j.href.split("#")[0]||"#"!==p[0]&&0!==f(e.href).indexOf(p)||"#"===p[0]&&e.href.split(p)[0]!==j.href.split(p)[0])&&l(a(e.href),e.title||E.title))&&t.preventDefault()}}function l(t,e,n){return P?(t=p+o(t),e=e||E.title,n?P.replaceState(null,e,t):P.pushState(null,e,t),E.title=e,R=!1,c(),R):D[O]("emit",a(t))}var h,p,d,m,v,g=function(t){t=t||{};var e={},n=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(n,r){return"function"==typeof r&&(e[n]=e[n]||[]).push(r),t},enumerable:!1,writable:!1,configurable:!1},off:{value:function(n,r){if("*"!=n||r)if(r)for(var i,o=e[n],u=0;i=o&&o[u];++u)i==r&&o.splice(u--,1);else delete e[n];else e={};return t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(e,n){function r(){t.off(e,r),n.apply(t,arguments)}return t.on(e,r)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(r){var i,o,u,f=arguments,a=arguments.length-1,c=new Array(a);for(u=0;a>u;u++)c[u]=f[u+1];for(i=n.call(e[r]||[],0),u=0;o=i[u];++u)o.apply(t,c);return e["*"]&&"*"!=r&&t.trigger.apply(t,["*",r].concat(c)),t},enumerable:!1,writable:!1,configurable:!1}}),t},b=/^.+?\/\/+[^\/]+/,y="EventListener",w="remove"+y,$="add"+y,A="hasAttribute",x="replace",K="popstate",N="hashchange",O="trigger",S=3,T="undefined"!=typeof window&&window,E="undefined"!=typeof document&&document,P=T&&history,j=T&&(P.location||T.location),k=i.prototype,q=E&&E.ontouchstart?"touchstart":"click",D=g(),L=!1,R=!1,_=[],z=0;k.m=function(t,e,n){!u(t)||e&&!u(e)?e?this.r(t,e):this.r("@",t):l(t,e,n||!1)},k.s=function(){this.off("*"),this.$=[]},k.e=function(t){this.$.concat("@").some(function(e){var n=("@"===e?m:v)(o(t),o(e));return"undefined"!=typeof n?(this[O].apply(null,[e].concat(n)),R=!0):void 0},this)},k.r=function(t,e){"@"!==t&&(t="/"+o(t),this.$.push(t)),this.on(t,e)};var B=new i,C=B.m.bind(B);return C.create=function(){var t=new i,e=t.m.bind(t);return e.stop=t.s.bind(t),e},C.base=function(t){p=t||"#",d=a()},C.exec=function(){c(!0)},C.parser=function(n,r){n||r||(m=t,v=e),n&&(m=n),r&&(v=r)},C.query=function(){var t={},e=j.href||d;return e[x](/[?&](.+?)=([^&]*)/g,function(e,n,r){t[n]=r}),t},C.stop=function(){L&&(T&&(T[w](K,h),T[w](N,h),E[w](q,s)),D[O]("stop"),L=!1)},C.start=function(t){L||(T&&("complete"===document.readyState?r(t):T[$]("load",function(){setTimeout(function(){r(t)},1)})),L=!0)},C.base(),C.parser(),C});