!function(e,t,i,n){"use strict";t(["jquery"],function(e){describe("Loader",function(){before(function(){i.undef("utils/loader"),i.undef("utils/module"),i.undef("utils/conditions"),i.undef("jquery"),i.undef("test"),i.undef("test1"),i.undef("test2"),i.undef("test-extension"),i.undef("test-extension1"),i.undef("test-extension2"),i.undef("test-priority")}),afterEach(function(){i.undef("utils/loader"),i.undef("utils/module"),i.undef("utils/conditions"),i.undef("jquery"),i.undef("test"),i.undef("test1"),i.undef("test2"),i.undef("test-extension"),i.undef("test-extension1"),i.undef("test-extension2"),i.undef("test-priority")}),it("should initialize with document as default scope",function(e){require(["utils/loader"],function(t){var i=new t({});expect(i.elementScope).to.be.deep.equal(document),e()})}),it("should initialize with an element scope",function(e){var t=document.createElement("div");require(["utils/loader"],function(i){var n=new i({elementScope:t});expect(n.elementScope).to.be.equal(t),e()})}),it("should accept a jquery element as its scope",function(t){var i=e("<div></div>");require(["utils/loader"],function(e){var n=new e({elementScope:i});expect(n.elementScope).to.be.equal(i.get(0)),t()})}),it("should init a module with the default class",function(i){var n=e('<div><div class="auto-init" data-module="test"></div></div>'),o={ready:sinon.spy()};t("test",[],function(){return o}),require(["utils/loader"],function(e){new e({elementScope:n});setTimeout(function(){expect(o.ready.calledOnce).to.be.equal(!0),i()},100)})}),it("should init a module with a custom class",function(i){var n=e('<div><div class="fancy-init" data-module="test"></div></div>'),o={ready:sinon.spy()};t("test",o),require(["utils/loader"],function(e){new e({elementScope:n,autoInitSelector:".fancy-init"});setTimeout(function(){expect(o.ready.calledOnce).to.be.equal(!0),i()},100)})}),it("should initialize multiple modules",function(i){var n=e('<div><div class="auto-init" data-module="test"></div><div class="auto-init" data-module="test"></div></div>'),o={ready:sinon.spy()};t("test",o),require(["utils/loader"],function(e){new e({elementScope:n});setTimeout(function(){expect(o.ready.calledTwice).to.be.equal(!0),i()},100)})}),it("should initialize priorized modules first",function(i){var n=e('<div><div class="auto-init" data-priority="false" data-module="test"></div><div class="auto-init" data-priority="true" data-module="test-priority"></div></div>'),o={ready:sinon.spy()},s={ready:sinon.spy()};t("test",o),t("test-priority",s),require(["utils/loader"],function(e){new e({elementScope:n});setTimeout(function(){expect(s.ready.calledBefore(o.ready)).to.be.equal(!0),i()},100)})}),it("should init global modules",function(i){var n=e('<div><div class="auto-init" data-module="test"></div></div>'),o={isGlobal:!0,ready:function(){}},s={};t("test",o),require(["utils/loader"],function(e){new e({elementScope:n,globalScope:s});setTimeout(function(){expect(s.test).to.be.an("object"),i()},50)})}),it("should init modules on a custom element",function(i){var n=e("<div></div>"),o=e('<div><div class="auto-init" data-module="test"></div></div>'),s={ready:sinon.spy()};t("test",s),require(["utils/loader"],function(e){var t=new e({elementScope:n});t.initModules(o),setTimeout(function(){expect(s.ready.calledOnce).to.be.equal(!0),i()},100)})}),it("should init modules with extension on a custom element",function(i){var n=e("<div></div>"),o=e('<div><div class="auto-init" data-module="test" data-extension="test-extension"></div></div>'),s={ready:sinon.spy()},d={extend:["test"],ready:function(){this._super(),this.test()},test:sinon.spy()};t("test",s),t("test-extension",d),require(["utils/loader"],function(e){var t=new e({elementScope:n});t.initModules(o),setTimeout(function(){expect(s.ready.calledOnce).to.be.equal(!0),expect(d.test.calledOnce).to.be.equal(!0),i()},100)})}),it("should extend just the spedified module",function(i){var n=e("<div></div>"),o=e('<div><div class="auto-init" data-module="test1, test2" data-extension="test-extension"></div></div>'),s={ready:sinon.spy()},d={ready:sinon.spy()},u={extend:["test1"],ready:sinon.spy()};t("test1",s),t("test2",d),t("test-extension",u),require(["utils/loader"],function(e){var t=new e({elementScope:n});t.initModules(o),setTimeout(function(){expect(s.ready.callCount).to.be.equal(0),expect(d.ready.calledOnce).to.be.equal(!0),expect(u.ready.calledOnce).to.be.equal(!0),i()},100)})}),it("should extend multiple spedified modules",function(i){var n=e("<div></div>"),o=e('<div><div class="auto-init" data-module="test1, test2" data-extension="test-extension"></div></div>'),s={ready:sinon.spy()},d={ready:sinon.spy()},u={extend:["test1","test2"],ready:sinon.spy()};t("test1",s),t("test2",d),t("test-extension",u),require(["utils/loader"],function(e){var t=new e({elementScope:n});t.initModules(o),setTimeout(function(){expect(s.ready.callCount).to.be.equal(0),expect(d.ready.callCount).to.be.equal(0),expect(u.ready.calledTwice).to.be.equal(!0),i()},100)})}),it("should extend multiple extensions on the spedified module",function(i){var n=e("<div></div>"),o=e('<div><div class="auto-init" data-module="test" data-extension="test-extension1, test-extension2"></div></div>'),s={ready:sinon.spy()},d={extend:["test"],ready:function(){this._super(),this.spy1()},spy1:sinon.spy()},u={extend:["test"],ready:function(){this._super(),this.spy2()},spy2:sinon.spy()};t("test",s),t("test-extension1",d),t("test-extension2",u),require(["utils/loader"],function(e){var t=new e({elementScope:n});t.initModules(o),setTimeout(function(){expect(s.ready.calledOnce).to.be.equal(!0),expect(d.spy1.calledOnce).to.be.equal(!0),expect(u.spy2.calledOnce).to.be.equal(!0),i()},100)})}),it("should resolve a promise when all modules are loaded",function(i){var n=e('<div><div class="auto-init" data-module="test"></div><div class="auto-init" data-module="test"></div></div>'),o={ready:sinon.spy()};t("test",o),require(["utils/loader"],function(e){var t=new e({elementScope:n,autoInit:!1});t.initModules().then(function(){expect(o.ready.calledTwice).to.be.equal(!0),i()})})}),it("should load a module when a condition is fired",function(i){var n=sinon.spy(),o=e('<div><div class="auto-init" data-module="test" data-condition=\'{"test": "test"}\'></div></div>'),s={ready:function(){expect(n.calledOnce).to.be.equal(!0),i()}},d={test:function(e,t){n(),e()}};t("test",s),t("utils/conditions",d),require(["utils/loader"],function(e){var t=new e({elementScope:o,autoInit:!1});t.initModules()})}),it("should load a module when a condition is fired (simple form)",function(i){var n=sinon.spy(),o=e('<div><div class="auto-init" data-module="test" data-condition="test"></div></div>'),s={ready:function(){expect(n.calledOnce).to.be.equal(!0),i()}},d={test:function(e,t){n(),e()}};t("test",s),t("utils/conditions",d),require(["utils/loader"],function(e){var t=new e({elementScope:o,autoInit:!1});t.initModules()})}),it("should disable the conditions load method after the first call",function(i){var n=sinon.spy(),o=e('<div><div class="auto-init" data-module="test" data-condition=\'{"test": "test"}\'></div></div>'),s={ready:sinon.spy()},d={test:function(e,t){n(),e(),e(),setTimeout(function(){expect(s.ready.calledOnce).to.be.equal(!0),i()},100)}};t("test",s),t("utils/conditions",d),require(["utils/loader"],function(e){var t=new e({elementScope:o,autoInit:!1});t.initModules()})})})})}(this,this.define,this.requirejs);